<p align="center">
  <a href="https://git.io/typing-svg"><img src="https://readme-typing-svg.demolab.com?font=Courier+Prime&size=65&pause=1000&color=F7CB27&center=true&vCenter=true&repeat=false&width=450&height=80&lines=TALLER+CRM" alt="Typing SVG" /></a>
</p>

<p>
  <h2 id="descripci√≥n">üìù Descripcion</h2>
  <p align="justify">API robusta para la gesti√≥n de clientes y trabajos en un sistema de presupuestos y seguimiento de pagos, desarrollada con Node.js y MongoDB. Esta API permite a los talleres de herrer√≠a organizar eficientemente sus operaciones, brindando un control detallado sobre los clientes, la creaci√≥n de trabajos personalizados, la generaci√≥n de presupuestos con desglose de materiales y costos, y el seguimiento de los pagos asociados. Pensada para integrarse f√°cilmente con aplicaciones frontend, esta API maneja autenticaci√≥n segura, administraci√≥n de roles, y validaci√≥n de datos, garantizando tanto la seguridad como la precisi√≥n en cada interacci√≥n. Adem√°s, el sistema es escalable, lo que facilita su personalizaci√≥n y expansi√≥n para adaptarse a las crecientes necesidades del taller.</p>
</p>

<details open>
  <summary><h2>üìë Tabla de Contenidos</h2></summary>
  <ul>
    <li><a href="#descripci√≥n">Descripci√≥n</a></li>
    <li><a href="#instalaci√≥n-y-requisitos">Instalaci√≥n y Requisitos</a></li>
    <li><a href="#endpoints-de-la-api">Endpoints de la API</a></li>
    <li><a href="#tecnolog√≠as-usadas">Tecnolog√≠as Usadas</a></li>
    <li><a href="#estructura-de-carpetas">Estructura de Carpetas</a></li>
    <li><a href="#pruebas">Pruebas</a></li>
    <li><a href="#licencia">Licencia</a></li>
  </ul>
</details>

<details open>
  <summary><h2 id="instalaci√≥n-y-requisitos">üõ†Ô∏è Instalaci√≥n y Requisitos</h2></summary>
  <h4>üìã Requisitos Previos</h4>
  <p>
    <a href="https://github.com/search?q=user%3AJaviB10+language%3Ajavascript"><img alt="Static Badge" src="https://img.shields.io/badge/NodeJS%20-%20brightgreen?style=plastic&logo=nodedotjs&logoColor=%23000000&color=%235FA04E"></a>
    <a><img alt="Static Badge" src="https://img.shields.io/badge/MongoDB%20-%20brightgreen?style=plastic&logo=mongodb&logoColor=%23000000&color=%2347A248"></a>
  </p>
  <h4>üõ†Ô∏è Instalacion</h4>
  <h5>1 - Clonar el Repositorio</h5>
  
  ```bash
  git clone https://github.com/tuusuario/tu-repo.git
  cd tu-repo
  ```
  <h5>2 - Instalar Dependencias</h5>
  
  ```bash
  npm install
  ```
  <h5>3 - Configurar Variables de Entorno</h5>

  ```bash
  PORT= Numero del puerto con el que se hara conexion
  MONGO_URL= String de conexion a la base de datos con la cual se va a trabajar
  PRIVATE_KEY= Clave privada
  PASS_DEFAULT= Clave por defecto
  ENT= Tipo de entorno de trabajo
  ```
  <h5>4 - Iniciar el Servidor</h5>

  ```bash
  npm start
  ```
</details>

<details>
  <summary><h2 id="endpoints-de-la-api">üåê Endpoints de la API</h2></summary>
  
  <h3>üîí Autenticaci√≥n</h3>
  <ul>
      <li>
          <strong>POST /api/sessions/login</strong> - Inicia sesi√≥n y devuelve un token. <br>
          <code>{ "email": "user@example.com", "password": "yourpassword" }</code>
      </li>
      <li>
          <strong>POST /api/sessions/logout</strong> - Cierra la session y destruye el token de acceso.
      </li>
  </ul>
  <h3>üë§ Usuarios</h3>
  <ul>
      <li>
          <strong>GET /api/users</strong> - Devuelve la lista de usuarios.
      </li>
      <li>
          <strong>GET /api/users/:uid</strong> - Devuelve los detalles de un usuario espec√≠fico.
      </li>
      <li>
          <strong>POST /api/users/email</strong> - Devuelve los detalles de un usuario espec√≠fico por su email.
      </li>
      <li>
          <strong>POST /api/users</strong> - Crea un nuevo usuario. <br>
          <code>{ "name": "Julieta", "lastName": "Ballon", "phone": "3415678765", "email": "user@example.com", "password": "yourpassword" }</code>
      </li>
      <li>
          <strong>PUT /api/users/:uid</strong> - Actualiza la informaci√≥n de un usuario espec√≠fico.
      </li>
      <li>
          <strong>DELETE /api/users/:uid</strong> - Elimina un usuario espec√≠fico.
      </li>
  </ul>
  <h3>üë• Clientes</h3>
  <ul>
      <li>
          <strong>GET /api/clients</strong> - Devuelve la lista de clientes
      </li>
      <li>
          <strong>GET /api/clients/:cid</strong> - Devuelve los detalles de un cliente espec√≠fico.
      </li>
      <li>
          <strong>POST /api/clients/phone</strong> - Devuelve los detalles de un cliente espec√≠fico por su telefono.
      </li>
      <li>
          <strong>POST /api/clients</strong> - Crea un nuevo cliente. <br>
          <code>{ "name": "Julieta", "lastName": "Ballon", "address": "Italia 3040", "phone": "3415678765" }</code>
      </li>
      <li>
          <strong>PUT /api/clients/:cid</strong> - Actualiza la informaci√≥n de un cliente espec√≠fico.
      </li>
      <li>
          <strong>DELETE /api/clients/:cid</strong> - Elimina un cliente espec√≠fico.
      </li>
  </ul>
  <h3>üõ†Ô∏è Trabajos</h3>
  <ul>
      <li>
          <strong>GET /api/jobs</strong> - Devuelve la lista de trabajos.
      </li>
      <li>
          <strong>GET /api/jobs/:jid</strong> - Devuelve los detalles de un trabajo espec√≠fico.
      </li>
      <li>
          <strong>POST /api/jobs/:cid</strong> - Crea un nuevo trabajo. <br>
          <code>{ "details": "Breve detalle del trabajo" }</code>
      </li>
      <li>
          <strong>PUT /api/jobs/:jid</strong> - Actualiza la informaci√≥n de un trabajo espec√≠fico. <br>
          <code>{ "details": "Breve detalle del trabajo", "isFinished": true, "budgetAccepted": true }</code>
      </li>
      <li>
          <strong>DELETE /api/jobs/:jid</strong> - Elimina un trabajo espec√≠fico.
      </li>
  </ul>
  <h3>üí∞ Presupuestos</h3>
  <ul>
      <li>
          <strong>GET /api/budgets</strong> - Devuelve la lista de presupuestos.
      </li>
      <li>
          <strong>GET /api/budgets/:bid</strong> - Devuelve los detalles de un presupuesto espec√≠fico.
      </li>
      <li>
          <strong>PUT /api/budgets/:bid</strong> -  Actualiza la informaci√≥n de un presupuesto espec√≠fico. <br>
          <code>{ "labourCost": "Costo que tendra el trabajo" }</code>
      </li>
      <li>
          <strong>PUT /api/budgets/material/:bid</strong> -  Actualiza la informaci√≥n de un material dentro de un presupuesto espec√≠fico. <br>
          <code>{ "materialName": "Nombre del material", "amount": "Cantidad de material", "price": "Precio unitario del material" }</code>
      </li>
      <li>
          <strong>GET /api/budgets/remove/:bid</strong> -  Elimina un material dentro de unp presupuesto espec√≠fico.
      </li>
  </ul>
  <h3>üíµ Pagos</h3>
  <ul>
      <li>
          <strong>GET /api/payments</strong> - Devuelve la lista de pagos.
      </li>
      <li>
          <strong>GET /api/payments/:pid</strong> - Devuelve los detalles de un pago espec√≠fico.
      </li>
      <li>
          <strong>POST /api/payments/:bid</strong> - Registra un nuevo pago. <br>
          <code>{ "amount": "Monto pagado", "paymentMethod": "Metodo de pago", "notes": "Nota sobre el pago si es necesario" }</code>
      </li>
      <li>
          <strong>PUT /api/payments/:pid</strong> - Actualiza la informaci√≥n de un pago espec√≠fico.
          <code>{ "amount": "Monto pagado", "paymentMethod": "Metodo de pago", "notes": "Nota sobre el pago si es necesario" }</code>
      </li>
      <li>
          <strong>DELETE /api/payments/:pid</strong> - Elimina un pago espec√≠fico.
      </li>
  </ul>
  <h3>üßæ Facturas</h3>
  <ul>
      <li>
          <strong>GET /api/invoices/:cid</strong> - Confecciona una factura con los datos completos del cliente, trabajos, presupuestos, materiales y pagos.
      </li>
  </ul>
</details>

<details>
  <summary><h2 id="tecnolog√≠as-usadas">‚öôÔ∏è Tecnolog√≠as Usadas</h2></summary>
  <ul>
      <li><strong>Node.js</strong> - Entorno de ejecuci√≥n de JavaScript en el servidor.</li>
      <li><strong>Express</strong> - Framework web para Node.js, que facilita la creaci√≥n de aplicaciones y APIs.</li>
      <li><strong>Mongoose</strong> - ODM (Object Data Modeling) para MongoDB y Node.js, que simplifica la interacci√≥n con la base de datos.</li>
      <li><strong>Bcrypt</strong> - Librer√≠a para encriptar contrase√±as.</li>
      <li><strong>JWT (JSON Web Token)</strong> - Para gestionar autenticaci√≥n y autorizaci√≥n en aplicaciones web.</li>
      <li><strong>Passport</strong> - Middleware para autenticaci√≥n en Node.js, compatible con diferentes estrategias.</li>
      <li><strong>Mocha</strong> - Framework de pruebas para Node.js.</li>
      <li><strong>Chai</strong> - Librer√≠a de aserciones para Mocha, que facilita la escritura de pruebas.</li>
      <li><strong>Swagger</strong> - Herramientas para documentar y dise√±ar APIs.</li>
      <li><strong>PDFKit</strong> - Librer√≠a para generar documentos PDF en Node.js.</li>
      <li><strong>CORS</strong> - Middleware que permite controlar el acceso de recursos entre dominios.</li>
      <li><strong>Dotenv</strong> - Carga variables de entorno desde un archivo `.env`.</li>
      <li><strong>Commander</strong> - Para crear interfaces de l√≠nea de comandos (CLI) en Node.js.</li>
      <li><strong>Cookie-parser</strong> - Middleware para parsear cookies en las solicitudes.</li>
      <li><strong>Yamljs</strong> - Librer√≠a para trabajar con archivos YAML en JavaScript.</li>
      <li><strong>Supertest</strong> - Librer√≠a para realizar pruebas de integraci√≥n HTTP.</li>
      <li><strong>Winston</strong> - Librer√≠a de registro para aplicaciones Node.js.</li>
      <li><strong>Concurrently</strong> - Permite ejecutar m√∫ltiples comandos de forma concurrente en la terminal.</li>
  </ul>
</details>

<details>
  <summary><h2 id="estructura-de-carpetas">üìÇ Estructura de Carpetas</h2></summary>
  <pre>
  <code>
  src/
  ‚îÇ
  ‚îú‚îÄ‚îÄ assets/
  ‚îÇ   ‚îú‚îÄ‚îÄ fonts/
  ‚îÇ   ‚îî‚îÄ‚îÄ images/
  ‚îÇ  
  ‚îÇ‚îÄ‚îÄ config/
  ‚îÇ
  ‚îú‚îÄ‚îÄ controllers/
  ‚îÇ
  ‚îú‚îÄ‚îÄ DAOs/
  ‚îÇ   ‚îú‚îÄ‚îÄ mongo/
  ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ budgets.mongo.js
  ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ clients.mongo.js
  ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ jobs.mongo.js
  ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ payments.mongo.js
  ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ users.mongo.js
  ‚îÇ   ‚îî‚îÄ‚îÄ factory.js
  ‚îÇ
  ‚îú‚îÄ‚îÄ docs/
  ‚îÇ   ‚îú‚îÄ‚îÄ budget/
  ‚îÇ   ‚îú‚îÄ‚îÄ client/
  ‚îÇ   ‚îú‚îÄ‚îÄ job/
  ‚îÇ   ‚îú‚îÄ‚îÄ payment/
  ‚îÇ   ‚îú‚îÄ‚îÄ session/
  ‚îÇ   ‚îî‚îÄ‚îÄ user/
  ‚îÇ
  ‚îú‚îÄ‚îÄ middlewares/
  ‚îÇ
  ‚îú‚îÄ‚îÄ repositories/
  ‚îÇ
  ‚îú‚îÄ‚îÄ routes/
  ‚îÇ   ‚îú‚îÄ‚îÄ api/
  ‚îÇ   ‚îî‚îÄ‚îÄ router.js
  ‚îÇ
  ‚îú‚îÄ‚îÄ services/
  ‚îÇ
  ‚îú‚îÄ‚îÄ utils/
  ‚îÇ
  ‚îú‚îÄ‚îÄ app.js
  tests/
  .env.example
  </code>
  </pre>
</details>

<details>
  <summary><h2 id="pruebas">üß™ Pruebas</h2></summary>
  <h5>1 - Iniciar el servidor</h5>
  
  ```bash
  npm start
  ```

  <h5>2 - Iniciar las pruebas</h5>
  
  ```bash
  npm test
  ```
</details>

<details>
  <summary><h2>üìñ Documentaci√≥n de la API con Swagger</h2></summary>
  <h5>Para facilitar la comprensi√≥n y uso de la API, se ha integrado Swagger en el proyecto. Puedes acceder a la documentaci√≥n interactiva de la API en la siguiente URL:</h5>
  
  http://localhost:8080/api-docs

  <p><strong>(Nota: Aseg√∫rate de reemplazar `localhost:8080` con la URL de tu servidor si est√°s desplegando la aplicaci√≥n en un entorno diferente.)</strong></p>
  
  <h5>¬øQu√© es Swagger?</h5>
  
  <p>Swagger es una herramienta que permite documentar APIs de forma visual, facilitando a los desarrolladores entender c√≥mo interactuar con los diferentes endpoints disponibles. Con la interfaz de Swagger, puedes probar cada endpoint directamente desde el navegador.</p>
  
  <h5>C√≥mo usar Swagger</h5>
  <ul>
      <li><strong>Accede a la URL de Swagger:</strong> Abre tu navegador y ve a la URL mencionada anteriormente.</li>
      <li><strong>Explora los endpoints:</strong> Puedes ver todos los endpoints disponibles, junto con sus m√©todos (GET, POST, etc.) y par√°metros.</li>
      <li><strong>Probar la API:</strong> 
        <ul>
          <li>Primero, utiliza el endpoint de `/sessions` para autenticarte. Este endpoint te devolver√° un token que necesitar√°s para autorizar tus solicitudes a otros endpoints.</li>
          <li>Segundo, en la parte superior encontraras un boton AUTHORIZE, ahi deberas colocar el token obtenido y validarlo.</li>
          <li>Tercero, selecciona cualquier endpoint y usa el bot√≥n "Try it out" para probarlo con datos de entrada. Swagger mostrar√° la respuesta de la API en tiempo real.</li>
        </ul>
  </ul>
  <p>Aseg√∫rate de que tu servidor est√© en funcionamiento para acceder a la documentaci√≥n.</p>
</details>

<details open id="licencia">
  <summary><h2>üìú Licencia</h2></summary>
  <h4>Distribuido bajo la licencia MIT.</h4>
</details>

